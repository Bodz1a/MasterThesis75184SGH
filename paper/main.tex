% Style for a MSc paper at Warsaw School of Economics
% Michał Ramsza
% Fri Dec 22 14:49:36 CET 2023

% --- document class and other global stuff ---------------------------
\documentclass[english, twoside, 12pt, a4paper]{article}

% --- packages --------------------------------------------------------
\usepackage{textcomp}
\usepackage{times}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{graphicx}
\usepackage{tikz}
\usepackage{xcolor}
\usepackage{enumitem}
\usepackage[english]{babel}
\usepackage{booktabs}
\usepackage{setspace}
\usepackage{csquotes}
\usepackage[centering, left=3.5cm, right=2.5cm, textheight=24cm]{geometry}

% --- packages for citations ------------------------------------------
\usepackage[backend=biber, style=authoryear, autocite=inline, defernumbers=true]{biblatex}
\addbibresource{refs.bib}

% --- package for automatic insertion of R code -----------------------
\usepackage{listings}
\lstset{%
   numbers=left,%
   tabsize=3,%
   numberstyle=\footnotesize,%
   basicstyle=\ttfamily \small \color{black},%
   keywordstyle=\ttfamily \small \color{black},%
   commentstyle=\ttfamily \small \color{gray},%
   stringstyle=\ttfamily \small \color{black},%
   identifierstyle=,%
   showstringspaces=false,%
   escapeinside={(*@}{@*)}}   
   
\lstset{
 literate={ą}{{\k a}}1
 {Ą}{{\k A}}1
 {ż}{{\. z}}1
 {Ż}{{\. Z}}1
 {ź}{{\' z}}1
 {Ź}{{\' Z}}1
 {ć}{{\' c}}1
 {Ć}{{\' C}}1
 {ę}{{\k e}}1
 {Ę}{{\k E}}1
 {ó}{{\' o}}1
 {Ó}{{\' O}}1
 {ń}{{\' n}}1
 {Ń}{{\' N}}1
 {ś}{{\' s}}1
 {Ś}{{\' S}}1
 {ł}{{\l}}1
 {Ł}{{\L}}1
}   

% --- support for links -----------------------------------------------	
\usepackage{hyperref}
\hypersetup{colorlinks=true,
            linkcolor=black,
            citecolor=darkgray,
            urlcolor=darkgray}
\usepackage{xurl}            
\urlstyle{same}

% --- support for large tables and other stuff ------------------------	
\usepackage{float}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{wrapfig}

% --- support for game theory ------------------------------------------
\usepackage{sgame}

% --- support for no widows --------------------------------------------
\usepackage[defaultlines=4,all]{nowidow}

% -----------------------------------------------------------
\usepackage{setspace}

% --- definitions for environments -------------------------------------
\theoremstyle{definition}
    \newtheorem{condition}{Assumption}
    \newtheorem{example}{Example}      

\theoremstyle{plain}
    \newtheorem{definition}{Definition}    
    \newtheorem{proposition}{Proposition}
    \newtheorem{theorem}{Theorem}
    \newtheorem{cor}{Corollary}

\theoremstyle{remark}
    \newtheorem{remark}{Remark}

% --- other settings --------------------------------------------------
\linespread{1.5}
\frenchspacing
\sloppy
\allowdisplaybreaks[4]
\raggedbottom
\clubpenalty=10000
\widowpenalty=10000

% --- only if required ------------------------------------------------
\AtBeginDocument{\renewcommand*{\figurename}{Figure}}
\AtBeginDocument{\renewcommand*{\tablename}{Table}}

% --- changing definition of footnote ---------------------------------
\makeatletter
\renewcommand\footnotesize{%
   \@setfontsize\footnotesize\@ixpt{10}%
   \abovedisplayskip 8\p@ \@plus2\p@ \@minus4\p@
   \abovedisplayshortskip \z@ \@plus\p@
   \belowdisplayshortskip 4\p@ \@plus2\p@ \@minus2\p@
   \def\@listi{\leftmargin\leftmargini
               \topsep 4\p@ \@plus2\p@ \@minus2\p@
               \parsep 2\p@ \@plus\p@ \@minus\p@
               \itemsep \parsep}%
   \belowdisplayskip \abovedisplayskip
}
\makeatother

% --- useful definitions ----------------------------------------------
\newcommand{\code}[1]{\lstinline{#1}}
\newcommand{\setn}{\mathbb{N}}
\newcommand{\Beta}{\mathrm{Beta}}
\newcommand{\prob}[1]{\mathbb{P}\left( #1\right)}
\newcommand{\buy}{{\cal B}}
\newcommand{\mean}[1]{\mathbb{E} \left( #1 \right)}

% ---------------------------------------------------------------------
\begin{document}

% --- strona tytulowa -------------------------------------------------
\begin{titlepage}
\centering

\includegraphics[width=0.66\textwidth]{logo.JPG}

\vspace*{0.5cm}
Master's study\\
\begin{flushleft}
Field of study: Advanced Analytics – Big Data\\
%Specjalność: <specjalność> % w przypadku braku należy pominać
%Forma studiów: <forma studiów (stacjonarne, itd.)>
\end{flushleft}

\vspace*{.5cm}
\rule{0cm}{1cm}\hfill
\begin{minipage}{9cm}
Author's first name and surname: Bogdan Bojarin\\
Student's register No.: 75184
\end{minipage}

\vspace*{1cm}
\begin{minipage}{12cm}
\centering
\Large
\textbf{Learning and Competition\\in the Differentiated Products Market}
\end{minipage}

\vspace*{2cm}
\rule{0cm}{1cm}\hfill
\begin{minipage}{9cm}
Master's thesis
under the scientific supervision of\\
dr hab. Michał Ramsza\\
written in\\
Institute of Mathematical Economics\\
\end{minipage}

\vfill
Warsaw 2026
\end{titlepage}

\rule{1ex}{0ex}\clearpage

% --- table of contents -----------------------------------------------
\cleardoublepage
\tableofcontents

% --- chapter ---------------------------------------------------------
\cleardoublepage
\section{Introduction}

% Here, we need to introduce the topic, explain why it is interesting, and explain how it connects to theoretical economics. We also need to conduct a literature review.

Firms on real markets need to make pricing and product design decisions in diverse consumer environments with limited information. Consumers have different preferences and willingness to pay for product attributes, and firms tend not to directly see them and cannot accurately forecast demand. Rather, firms use these data over time to direct their decisions. Knowing how companies set prices and attribute products in such contexts is a central question in industrial economics and microeconomics. 

Conventional economic models commonly concern firm behavior with static equilibrium models while using a strong information assumption to establish firm performance. Traditional price competition classic models assume that firms know what is needed and are solving problems analytically in order to reach the equilibrium approach. Although the theoretical contribution of these models is crucial, they lack the insights from two characteristic areas central to many real-world markets: the heterogeneity of consumer preferences and the fact that firms typically learn about demand through experimentation rather than necessarily perfect information. 

This paper constructs some of the components of the structural model of consumer demand in which individual consumers vary in their willingness to pay and prefer product attributes. To compete in a market for distinctively priced goods, companies decide not just on prices but also on the features of the products. Demand is the outcome of individual consumer choices, probabilistically dependent on price and the level of conformity of all features of the product with consumer preferences. Consequently, aggregate demand and firm profits are endogenous results of heterogeneous economic decisions at the micro level. 

Because those profit functions usually do not support analytical solutions, the firms' optimization problems are solved numerically. Rather than simply assuming that a firm immediately calculates equilibrium strategies, it employs a simulation-based model in which firms investigate market effects and adapt their alternatives. In both cases, the method provides an opportunity to study market behavior under a limited amount of data, whilst also serving as a bridge between theoretical demand models and algorithmic decision making. To clearly demonstrate how consumer heterogeneity affects pricing, product design, and overall, the model is first devised around one firm. The model may be replicated with several firms engaged in a given market in which each firm's customer demand is uncertain in terms of the degree of uncertainty on consumers' demand and the behavior of its competitors. Under such circumstances, equilibrium results are reached by repeated interactions and learning, rather than through explicit decision making. 

The thesis adds to knowledge on price and product competition in differentiated markets by applying a solid demand structure with mathematical and simulation-based solution methods. This approach is firmly rooted in economic theory, although it recognises the reality of features in real-world scenarios like learning, experimenting, and information that cannot be accurately modeled with an analytical approach. For this reason, it offers a flexible basis for studying firm behavior in modern markets characterized by a range of product-based distinctions and consumer heterogeneity, hence product differentiation as a key element of study.

\clearpage
\section{Literature review}

% The place for literature review.

One of the first and most significant works in the field of development and research of agent-oriented models is considered to be the work ``Growing Artificial Societies'' by \textcite{epstein1996}, in which the authors put forward a new research program based on agent-oriented modeling. Of course, they were not the first to use an agent-based approach in the study of socio-economic phenomena. The first meaningful attempts to apply it can be found in the works of Schelling (1971), Albin and Foley (1990), Axelrod and Bennett (1993), Axelrod (1997), Danielson (1996), and others. However, Epstein and Axtell were the first to explicitly outline the contours of a new methodology. Following \textcite{epstein1996}:

\begin{quote}
\textit{``Our broad goal is to begin developing a unified social science in which evolutionary processes would be embedded in a computational environment that simulates social and economic phenomena. One day, when people ask about the possibility of explaining something, they will mean the ability to grow it in silico, demonstrating how a limited set of microfactors generates macro-phenomena. The development of IT technologies opens up the prospect of looking at the world of social phenomena through the prism of a new science''.}
\end{quote}

The research program on artificial societies sees the prospect of overcoming the problem of the subjective component of social processes in the development of computing technologies and agent-oriented modeling methodology. Virtual analogues of the designed systems allow simulation experiments to be conducted and complex hypotheses to be generated and verified. Over the past decade, a large number of works have appeared that claim an agent-oriented approach as their methodological basis.

Despite sharing common fundamental features, including the presence of several autonomously acting entities seeking to maximize an inherent objective function, agent models can vary significantly in terms of the degree of abstraction and detail of the processes being analyzed. In one model, agents can be elementary entities of socio-economic relations, such as individuals (buyers, sellers, voters, road traffic participants) or aggregated entities acting on behalf of several individuals (legal entities, public law entities, unions, coalitions). Differences in the level of abstraction of agent models are determined by the specificity of the represented entities, the quality of the content of their target functions, and the ways in which they interact. There are also models represented by many agents, whose mechanisms and interaction goals are abstract in nature, are complex to parameterize and are focused on studying emerging behavior and emergent effects. Information about the modes of interaction of individual entities allows us to formulate and investigate hypotheses about the global dynamics of systems. However, possessing information about the global dynamics of a complex system allows us to formulate and test hypotheses about the rules of functioning of its constituent agents.

\paragraph{High-level abstraction agent modeling.} Highly abstract agent modeling is typically used in studies of objects with a high subjective component. An example of such an object is the marriage market, whose participants, being both commodities and consumers, make their choices based on several subjective criteria, such as age, level of education and wealth, skin color, ethnic origin of the partner, and more \textcite{tb2003}.

The breadth and analytical power of the agent-based approach in analyzing abstract subjects is reflected in examples of its application in studies of racial segregation \parencite{schelling1971}, the life cycle of firms \parencite{axtell2006}, stock market dynamics \parencite{sbe2018}, cultural convergence \parencite{axelrod1997}, or electoral procedures \parencite{hsm2019}.

Agent-based modeling differs from classical statistical and econometric approaches, which focus on simply calculating coefficients that determine the relationship between the resulting variables and the assumed regressors, in that it aims to reveal the hidden secrets of the phenomenon under study. It is this advantage that makes it indispensable when studying structural effects.

\paragraph{Low-level abstraction agent modeling. } Low-level abstraction agent models are usually and most commonly applied in practice. The subjects in them are defined at the level of individuals taken in specific systems of relations. The relative simplicity of quantitative parameterization and the low dispersion of results variation with identical inputs make such models convenient and reliable forecasting tools. The impact of variations in individual elements on the global dynamics of modeled systems can be intuitively predictable. However, including a large number of factors and types of interacting subjects in the analysis significantly reduces the quality of speculative forecasts. This is precisely where the applied significance of models of this type, widely used in demographic studies, consumer choice studies, evacuation models \parencite{ht2000}, transport optimization \parencite{np1995}, pedestrian traffic \parencite{hm1995}, and many more.

\paragraph{Criticism and evaluation of the methodology's capabilities. } Critically commenting on the methodology of agent-based modeling, American anthropologist S. Helmreich notes that the cultivation of artificial society structures is a formalization of research biases \parencite{helmreich1998}. This observation is not without merit. However, despite the vulnerability of the agent-based approach to such criticism, its solid scientific foundations cannot be denied—any conclusions obtained with its help are fundamentally falsifiable (in the Popperian sense), and therefore open to empirical verification. Today, the methodology of the agent-oriented approach continues to develop actively. More and more publications are appearing in the literature devoted to a critical analysis of its practical application. The high interdisciplinary potential of the methodology hinders the development of universal criteria for the validity of agent models. The requirements for simulation experiments are actively debated. In particular, the issue of the stability (robustness) of results and the framework of quantitative sufficiency of emulation runs is discussed \parencite{ljs2015}.

The growing trend toward agent-based modeling in the study of abstract objects suggests it will soon be applied in the humanities to address issues in philosophy, psychology, and creativity. In the near future, the agent-based approach will be transformed by the rapidly developing field of artificial intelligence. Opportunities are emerging for the construction of highly complex simulators based on highly intelligent agents \parencite{vallacher2017}. We can expect to see the reconstruction of old models based on more sophisticated operating algorithms. The current agenda allows us to predict an increase in the use of the agent-based approach in analyzing epidemics and the consequences of other external economic shocks \parencite{ylz2018}.

The development of digital technologies has led to a qualitative change in the utilitarian properties of computing technology. Software adaptation of complex cognitive schemes has turned the computer into an innovative tool for solving creative problems. The increase in the computing power of modern computers, the development of new cognitive technologies, and the agent-oriented approach in particular, are bringing humanity closer to the possibility of solving problems of unlimited complexity.

% --- chapter ---------------------------------------------------------
\clearpage
\section{Mathematical models}

Here, we give a mathematical formulation of all models, but also for every model, we numerically solve the model for some selected values of exogenous parameters. We need to make those variables exactly the same as the one we take for simulations so that we can compare the results.

\subsection{A model with a single firm}

Herein, we describe a mathematical model of a market with a single firm. The model's aim is to explain how heterogeneity among consumers creates demand and how a firm will choose prices and product attributes in response to that demand. Since the resulting profit function does not admit a closed-form solution, the decision problem of the firm is analyzed using a numerical, algorithmic approach reflecting learning.

\paragraph{A model of a consumer population.} 

% definition of an agent
We consider a market populated by a large number of consumers\footnote{We also refer to consumers as agents because we use agent-based simulations later when solving the model. We use these names interchangeably.} \(N \in \setn\). Agents are heterogeneous along two dimensions: reservation price, where each consumer \(i\) has a reservation price $r_i > 0$ showing the maximum price at which the consumer would buy the product, and taste (the ideal product characteristic), where each consumer $i$ has a preferred product characteristic $s_i \in [0,1]$. These two numbers are realizations of two random variables $R$ and $S$. We assume that these random variables are independent. 

We further assume that these random variables are continuous distributions. In the numerical implementation used throughout the thesis, the Gamma distribution was used for the random variable $R$ to reflect that there is a certain common reservation price in the population, but that there are some deviations as well. The type of distribution of the random variable $S$ models the style preferences of agents. Because we want the values of this distribution to fall in the interval $[0,1]$, we use the Beta distribution. The choice of the Beta distribution was made because it contains the Uniform distribution, but also it may reflect the fact that there is a common value for the style choice with some variation. Because of the choice of these two random variables, we know that reservation prices are positive and tastes belong to the interval $[0,1]$. These distributions provide a flexible and economically convincing description of consumer heterogeneity.

According to the model, agents make a binary decision: either purchase one unit of the product or do not buy at all. The (negative) utility of the agent represented by the reservation price \(r\) and the style type \(s\) from facing the good with price \(p\) and style \(o\) is the following
\begin{equation}\label{eq-utility-1}
u(r, s, p, o) = -\alpha \; \frac{p}{r} - \beta (s - o)^2
\end{equation}
where $r$ is a realization of the random variable $R$, $s$ is a realization of the random variable $S$, $p$ is the offered price of a good (assumed non-negative) with the style $o \in [0,1]$. In the formula \eqref{eq-utility-1}, the parameters \(r\) and \(s\) describe the consumer (the agent), and the parameters $p$ and $o$ describe the good. Both these latter parameters are controlled by a firm producing the good. This specification takes into account such key economic factors as the decrease in the utility as price increases relative to the agent’s reservation price $r$ and with the squared distance between the consumer’s ideal style $s$ and the product characteristic $o$.

If a single consumer is drawn at random from the population, the formula \eqref{eq-utility-1} becomes a random variable \(U\) that reads
\begin{equation}\label{eq-rv-u}
U = -\alpha \; \frac{p}{R} - \beta (S - o)^2 .
\end{equation}

% a figure showing an example of the distribution of U
\begin{figure}[hbt]
  \centering
  \begin{subfigure}[t]{0.45\textwidth}
    \includegraphics[width=\textwidth]{./figs/w-fig-00-gamma.png}
    \caption{The distribution of reservation prices in the consumer population. The distribution is \(\Gamma(4, 1)\). This distribution is used throughout all simulations and numerical calculations.}
    \label{fig:gammabetaa}
  \end{subfigure}
  \hfill
  \begin{subfigure}[t]{0.45\textwidth}
    \includegraphics[width=\textwidth]{./figs/w-fig-01-beta-44.png}
    \caption{The distribution of styles in the consumer population. The distribution is \(\Beta(4, 4)\). In simulations, we also use the distributions \(\Beta(2, 5)\) and \(\Beta(5, 2)\) to simulate the assymetri style distributions.}
    \label{fig:gammabetab}
  \end{subfigure}
  
  \captionsetup{margin=10pt,font=small,labelfont=bf,width=.8\textwidth}

  \caption[Distributions of reservation prices and styles]{In all numerical calculations and simulations, we use two types of distributions. The gamma distribution for the distribution of reservation prices and the beta distribution for the distribution of styles. \textit{Source:} own calculations}\label{fig:gammabeta}
\end{figure}

% the choice of agent
Agents are assumed to decide whether to buy a good with some probability. The probability that an agent with characteristics $(r,s)$ buys the product given as \((p, o)\) is given by a logit rule:
\[
\prob{\text{buy}} = \frac{\exp\!\big(u\big)}{1 + \exp\!\big(u\big)} . 
\]
And the probability of not buying is given by the following formula:
\[
\prob{\text{not buy}} = 1 - \frac{\exp\!\big(u\big)}{1 + \exp\!\big(u\big)}
\]
In fact, the above probabilities are random variables. In particular, when a single consumer is drawn from the population at random, the probability of buying is a random variable $\buy$ that reads:
\[
\buy = \prob{\text{buy}}
= \frac{\exp(U)}{1 + \exp(U)}
= \frac{\exp\!\left(-\alpha \frac{p}{R} - \beta (S - o)^2\right)}
{1 + \exp\!\left(-\alpha \frac{p}{R} - \beta (S - o)^2\right)}.
\]

The above formulation follows the rational choice theory, in essence stating that the agents with higher utility are more likely to buy a product. However, it also introduces stochastic elements that model irrational aspects of decision-making, given that the firm does not know a particular agent's reservation price or preferred style precisely.

% a figure showing the distribution of probability of buying the good
\begin{figure}[hbt]
  \centering
  \begin{subfigure}[t]{0.45\textwidth}
    \includegraphics[width=\textwidth]{./figs/w-fig-02-p-1-0.5.png}
    \caption{The distribution of the probability of buying for \(R \sim \Gamma(4,1)\), \(\Beta(4, 4)\) and \(p=1, o = 1/2\). }
    \label{fig:probbuya}
  \end{subfigure}
  \hfill
  \begin{subfigure}[t]{0.45\textwidth}
    \includegraphics[width=\textwidth]{./figs/w-fig-02-p-1-1.png}
    \caption{The distribution of the probability of buying for \(R \sim \Gamma(4,1)\), \(\Beta(4, 4)\) and \(p=1, o = 1\).}
    \label{fig:probbuyb}
  \end{subfigure}

  \begin{subfigure}[t]{0.45\textwidth}
    \includegraphics[width=\textwidth]{./figs/w-fig-02-p-0-0.5.png}
    \caption{The distribution of the probability of buying for \(R \sim \Gamma(4,1)\), \(\Beta(4, 4)\) and \(p=0, o = 1/2\).}
    \label{fig:probbuyc}
  \end{subfigure}
  \hfill
  \begin{subfigure}[t]{0.45\textwidth}
    \includegraphics[width=\textwidth]{./figs/w-fig-02-p-10-0.5.png}
    \caption{The distribution of the probability of buying for \(R \sim \Gamma(4,1)\), \(\Beta(4, 4)\) and \(p=10, o = 1/2\).}
    \label{fig:probbuyd}
  \end{subfigure}
  
  \captionsetup{margin=10pt,font=small,labelfont=bf,width=.8\textwidth}

  \caption[Distribution of individual purchase probabilities]{Distribution of individual purchase probabilities under different price and product style scenarios. Panels compare moderate price with the style \(o\) aligned with the mean population style (figure \ref{fig:probbuya}), moderate price with extreme style \(o\) (figure \ref{fig:probbuyb}), zero price, and high price with the style \(o\) aligned with the mean population style, figures \ref{fig:probbuyc} and \ref{fig:probbuyd} respectively. \textit{Source:} own calculations}\label{fig:probbuy}
\end{figure}

% discussion for the above figure
Figure~\ref{fig:probbuy} shows the distribution of the random variable \(\buy\) under various values of the price \(p\) and the style \(o\). The first figure \ref{fig:probbuya} shows the most typical situation with a moderate price \(p = 1\) and the style \(o\) aligned perfectly with the mean population style \(\mean{S}\). Figure \ref{fig:probbuyb} shows the change in the distribution of the buying probability \(\buy\) when the style \(o\) is not aligned with the mean population style \(\mean{S}\). The probabilities shift to the lower values, hence the mean demand decreases as expected. Finally, figures \ref{fig:probbuyc} and \ref{fig:probbuyd} show the change in the distribution of the buying probability \(\buy\) with price shifts. The former figure shows the distribution of \(\buy\) for \(p = 0\). In this case, the distribution is concentrated about \(1/2\), which is the highest possible distribution. It's not completely concentrated because of the distribution of styles, but it's close. On the other hand, the latter figure shows the distribution of buying probability for large prices. In this case, the probabilities are low, leading to low demand. 

\paragraph{A model of a firm.}

A single firm supplies one product to the market. The firm chooses two decision variables: a price $p \geq 0$ and a product characteristic (style) $ s \in [0,1]$. For convenience, to indicate the expected profit of a single firm offering a good at price $p$ and with the style $o$, we assume that the cost function $c(x)=c \cdot x$, and $c>0$. Therefore, the cost function is linear. The expected profit of a firm is then the following:
\[
\begin{aligned}
	\Pi(p, o) = \mathbb{E}(\text{profit})
	&= \mathbb{E}\!\big(p \cdot \text{demand} - c(\text{demand})\big) \\
	&= \mathbb{E}\!\big(p \cdot \text{demand} - c \cdot \text{demand}\big) \\
	&= \mathbb{E}\!\big(p \cdot N \cdot \buy - c \cdot N \cdot \buy\big) \\
	&= \mathbb{E}\!\big((p - c)\cdot N \cdot \buy\big) \\
	&= (p - c)\cdot N \cdot \mathbb{E}(\buy),
\end{aligned}
\]
where
\[
\begin{aligned}
	\mathbb{E}(\buy)
	&= \mathbb{E}\!\left(
	\frac{\exp\!\left(-\alpha \frac{p}{R} - \beta (S - o)^2\right)}
	{1 + \exp\!\left(-\alpha \frac{p}{R} - \beta (S - o)^2\right)}
	\right) \\
	&= \int_{0}^{1} \int_{0}^{\infty}
	\frac{\exp\!\left(-\alpha \frac{p}{r} - \beta (s - o)^2\right)}
	{1 + \exp\!\left(-\alpha \frac{p}{r} - \beta (s - o)^2\right)}
	\, f_R(r)\, f_S(s)\, ds\, dr .
\end{aligned}
\]

Thus, the expected profit function generalizes the dilemma faced by a company: raising prices increases profit per unit of output, but reduces demand by decreasing the probability of buying. Since the expected buying probability is determined by a multivariate integral, the optimization problem cannot be solved analytically. Instead, it is approached numerically using a learning algorithm that simulates the firm's behavior while solving the following maximization problem:
\[
\max_{\substack{p \ge 0 \\ o \in [0,1]}}
\; \Pi(p,o)
= \max_{\substack{p \ge 0 \\ o \in [0,1]}}
\; (p - c)\, N\, \mathbb{E}\!\left(\buy(p,o)\right).
\]

% here we need to solve numerically the above maximization problem. It has nothing to do with the algorithm of a firm.
\begin{figure}[hbt]
  \centering

    \includegraphics[width=.75\textwidth]{./figs/w-profits.png}

  \captionsetup{margin=10pt,font=small,labelfont=bf,width=.8\textwidth}

  \caption[Expected profits]{Expected profits of a firm; the figure shows behavior in two distinct situations. The top one is when the style of the product is exactly matched to the average style of the population. The lower curve shows behavior when the style is not aligned with the population's average style. In both situations, there is a unique price that maximizes profit. \textit{Source:} own calculations}\label{fig:profit}
\end{figure}

% discussion of a figure showing the expected profit curves
Figure~\ref{fig:profit} presents the expected profit as a function of price for two different values of the product style \(o\). In this example, for both cases, the marginal cost is \(1/2\), and there are \(10\) consumers. The blue curve, where the product characteristic equals the average consumer taste \(o = \mean{S}\), lies above the red curve at all price levels. This means that better matching the product style to consumer preferences increases the probability of purchase and shifts the overall profit function upward. Thus, the correct style of the product results in higher maximum profit and stronger pricing power than misaligned style with average taste. 

Regardless of the product style \(o\), profit is low at low and very high prices. For low prices, even with a high but finite demand, the profit is low. On the other hand, at high prices, the probability of buying declines, leading to low demand. Thus, the profit is low. The dependence of the profit on the price is continuous; thus, there is a maximum. The simulations lead to the conclusion that the maximum is unique. 

%%% MR: this part needs to be rewritten from scratch so that it is more precise.
\paragraph{Simulation and an algorithm of a firm}

In the model, the firm lacks full knowledge of its demand function but adopts an algorithmic perspective guided by market outcomes, thereby learning from them. The main loop of the simulation is the following. 

\begin{enumerate}[noitemsep]

\item We set the maximum number of steps \(T\) and the simulation follows in steps \(t = 1, 2, \ldots, T\). We set \(t = 0\).

\item We fix the number of agents \(N\) and keep it constant throughout the simulation. Each agent in the population is assigned realizations of the random variables \(R\) and \(S\). 

\item We define two values of incremental changes to prices and styles. We denote them by \(\delta_{p}\) and \(\delta_{o}\), respectively. 

\item The firm selects initial central values for price $p_0$ and product characteristic $o_0$. These are just starting guesses. They do not necessarily have to be optimal. At random, the firm selects the variable to optimize, either the product's price \(p\) or its style \(o\). For example, if the price dimension is selected, the firm creates a small, local search grid of prices \((p_{0} - \delta_{p}, p_{0}, p_{0} + \delta_{p})\). The same happens if the style dimension is selected. 

\item For each of the elements in the local search grid, consumers make purchase decisions according to the probabilistic rule defined by the utility function. Thus, we adopt here the synchronic approach to modeling the consumer population. 

\item The firm observes the realized aggregate demands and computes realized profits. It selects the element \(p_t\) or \(o_t\) (depending on the selected search dimension) in the local search grid that yields the highest profit, making it the new center of the grid. We interpret the center of the local search grid as the current product price and style. 

\item The firm creates a new local search grid around the new center. We increase \(t\) by \(1\). 

\item If \(t < T\), go to step 5. If \(t = T\), then stop. 


\end{enumerate}

Economically, the firm is gradually increasing price when a higher markup does not lead to a loss of demand, decreasing price when demand is too sensitive, and moving its style toward the center of consumer tastes to reduce mismatch. This methodology is implied by the profit function being smooth, and by small steps eventually leading to the maximum, with a single peak. It is a simple numerical profit-maximization method based on repeated local comparisons.

\subsection{A model with two firms}

This subsection extends the single-firm framework to a market with two competing firms. The extension preserves the same structure of consumer heterogeneity and probabilistic choice, but modifies the agent's decision problem: instead of choosing between ``buy'' and ``not buy'' from one firm, consumers choose among firm 1, firm 2, and an outside option (no purchase) to allow demand to be split endogenously between firms as a function of both prices and product characteristics.

As for the model with single-firm, we consider a market populated by a large number $N$ of agents with the same characteristics, which are the reservation price $r_i > 0$ and taste, where each agent $i$ has a preferred product characteristic $s_i \in [0,1]$ with the same parametric choices for numerical analysis as in the single-firm model, which are Gamma distribution for $R$ and Beta distribution for $S$.

\paragraph{A model of a firm and agent population.}

There are two firms $j \in \{1,2\}$. Each firm supplies one product and chooses a price $p_j > 0$ and taste $o_j \in [0,1]$ with marginal cost $c_j > 0$. Given a consumer with characteristics $(r,s)$, indirect utility from purchasing from firm $j$ is specified similarly to the single-firm model:
\[
u_j(r, s, p_j, o_j)
= -\alpha \; \frac{p_j}{r}
- \beta (s - o_j)^2,
\qquad \alpha > 0,\; \beta > 0.
\]
As before, we can treat these utilities as random variables
\[
\begin{aligned}
U_1(R, S, p_1, o_1) &= -\alpha \; \frac{p_1}{R} - \beta (S - o_1)^2, \\
U_2(R, S, p_2, o_2) &= -\alpha \; \frac{p_2}{R} - \beta (S - o_2)^2, \\
\end{aligned}
\]

Agents choose among alternatives: not buying at all, buying from firm 1, or buying from firm 2. Again, we use a multinomial logit rule to model the buying probabilities. For an agent defined by values $(r,s)$ the probability of purchasing from firm $j \in \{1,2\}$ is:
\[
\buy_{j} = \prob{\text{buy from firm}\; j} =
\frac{\exp\!\big(U_j(R, S, p_j, o_j)\big)}
{1 + \exp\!\big(U_1(R, S, p_1, o_1)\big)
	+ \exp\!\big(U_2(R, S, p_2, o_2)\big)}.
\]
The probability of not buying is:
\[
\buy_0 = \prob{\text{not buying}} 
=
\frac{1}
{1 + \exp\!\big(U_1(R, S, p_1, o_1)\big)
	+ \exp\!\big(U_2(R,S, p_2, o_2)\big)}.
\]

Therefore, by construction, $\buy_0 + \buy_1 + \buy_2 = 1$ for all $(r,s)$. In fact, we can think of \(\buy\) as a three-dimensional random variable giving values in the simplex. As is usual, we can take an orthogonal projection and restrict ourselfs only to two dimensions. 


For convenience, let $Q_j$ denote total demand for firm $j$, that is \(Q_{j} = N \cdot \buy_{j}\). Under independent consumer decisions, expected demand is:
\[
\mean{Q_j(p_1, o_1, p_2, o_2)} = N\cdot  \mean{\buy_j},
\]
where, using the previous assumptions, we have 
\[
\mean{\buy_{j}}
=
\int_{0}^{\infty}
\int_{0}^{1}
\frac{\exp\!\big(u_j(r, s, p_j, o_j)\big)}
{1 + \exp\!\big(u_1(r, s, p_1, o_1)\big)
	+ \exp\!\big(u_2(r, s, p_2, o_2)\big)}
 f_R(r)\, f_S(s)\, ds\, dr.
\]
Firm $j$’s profit equals margin times quantity sold \(\pi_j = (p_j - c_j)\, Q_j\).  Expected profit is therefore:
\[
\Pi_j(p_1, o_1, p_2, o_2) 
= (p_j - c_j)\,\mean{Q_j(p_1, o_1, p_2, o_2)}
= (p_j - c_j)\, N\, \mean{\buy_{j}}.
\]

The essential characteristic of competition is that $\Pi_j$ depends on both firms’ decisions. For instance, an increase in $p_2$ typically raises firm 1’s demand by shifting consumers toward firm 1, all else equal. Likewise, changes in $o_1$ and $o_2$ affect substitution patterns through taste mismatch.

\paragraph{Equilibrium concept.}

A firm’s strategy is the pair $(p_j,o_j)$. The strategy profile is: $(p_1, p_2, o_1, o_2)$. The two-firm model constitutes a normal-form game in which each firm chooses $p_j$ and $o_j$ to maximize expected profit given the competitor’s strategy. A Nash equilibrium is a strategy profile \((p_1^*, o_1^*, p_2^*, o_2^*)\) such that each firm's strategy is a best response to the other's:
\[
\begin{aligned}
(p_1^*, o_1^*)
\in
&\arg\max_{\substack{p_1 \ge 0 \\ o_1 \in [0,1]}}
\Pi_1(p_1, o_1, p_2^*, o_2^*), \\
(p_2^*, o_2^*)
\in
&\arg\max_{\substack{p_2 \ge 0 \\ o_2 \in [0,1]}}
\Pi_2(p_2, o_2, p_1^*, o_1^*).
\end{aligned}
\]

Since expected demand is defined by integrals over heterogeneous consumer types, analytical best responses and closed-form equilibria are generally not applicable here. For this reason, the model is studied using numerical methods.

\paragraph{Simulation and firm's algorithms.}

In many real markets, firms cannot know the exact demand function or the distribution of consumer preferences, and they may not perfectly observe competitors' strategies. In the simulation with two firms, we use exactly the same algorithms of firms' behavior. However, because there are two firms, their behavior is interdependent. The firms move in alternating steps. It means that at the first step, the first firm moves, but then at the second step, the second firm moves, and the moves alternate.

This is an approximation of iterated best-response dynamics. Over time, strategies stabilize hopefully. Each firm slightly adjusts its price or product design while the competitor stays fixed, keeps only profitable changes, and repeats until neither firm can improve. The final outcome is an approximate Nash equilibrium.

 % --- chapter ---------------------------------------------------------
\clearpage
\section{Implementation of mathematical models}

% In this chapter we describe how we implemented the above mathematical models. So we do not give here any results, we just describe how we implement a consumer, how we implement a firm, what is an algorithm of the behavior of the firms, and so on and so forth.

In this chapter, computational implementation of the proposed mathematical models is described. The theoretical framework of consumer behavior, demand, and firm profit definitions assumes a continuous formulation and therefore, the expressions produced are not necessarily closed-form. Specifically, expected demand is a multidimensional integral expressed over heterogeneous consumer characteristics, and the optimization problems of the firms cannot be solved analytically. 

Hence the model is implemented numerically. This chapter describes the representation of agents numerically, demand and profit approximation, and computational modeling of firm behavior using an iterative algorithm.

The implementation requires specification of:
\begin{itemize}[noitemsep]
	\item Population size $N$,
	\item Distribution parameters for $R$ and $S$,
	\item Structural parameters $\alpha$ and $\beta$,
	\item Marginal costs $c_j$,
	\item Step sizes \(\delta_p,\, \delta_o\),
	\item Number of iterations $T$.
\end{itemize}

These parameters influence the smoothness of the profit function, the speed of convergence, and the precision of numerical approximations.

\paragraph{Numerical representation of agents.}
The theoretical model works on the basis of a continuum of heterogeneous consumers composed of random variables $R$ and $S$, and in our computational representation this continuum is approximated by a finite population of size $N$.

Each pair $(r_i,s_i)$ is independently drawn from the given distributions for reservation prices and tastes. The population is generated once at the start of the simulation and remains fixed throughout the analysis.

In the numerical implementation, the expected buying probabilities, which are given by integrals in the theoretical model, are approximated by sample averages over the simulated population. It replaces continuous integration with finite summation and allows the expected demand and profit functions to be evaluated efficiently for any candidate decision variables.

\[
\widehat{\mathbb{E}}\!\left[P(p,o)\right]
=
\frac{1}{N}
\sum_{i=1}^{N}
P(R_i, S_i; p, o).
\]

\paragraph{Numerical representation of firm.}
The purchase probabilities for each consumer $i$ and given firm decisions $(p,o)$ are computed deterministically for all consumers in the population, while total demand is approximated as the sum of individual purchase probabilities:

\[
\widehat{Q}(p,o)
=
\sum_{i=1}^{N} P_i(p,o).
\]

This formulation corresponds to the expected number of purchases over multiple sales periods. It avoids the additional randomness that arises in binary purchase simulations and provides a smooth profit function.

The profit is computed by the function:

\[
\widehat{\pi}(p,o)
=
(p - c)\, \widehat{Q}(p,o).
\]

Therefore, the profit can be evaluated for any candidate price and product characteristic and forms the basis for the firm’s decision-making algorithm.

\paragraph{Implementation of a single-firm algorithm.}

The firm’s optimization problem is solved using an iterative local improvement algorithm rather than direct analytical maximization. It is initialized by the following procedure:

\begin{enumerate}[noitemsep]
	\item Generate a consumer population.
	
	\item Select initial values $p_0$ and $o_0$.
	
	\item Choose step sizes $\delta_p$ and $\delta_o$.
\end{enumerate}

Local search procedure is constructed in such way, that at iteration $t$, given $(p_t, o_t)$, the firm evaluates candidate adjustments.

For price:
\[
p_t' \in \{p_t - \Delta p,\; p_t,\; p_t + \Delta p\}.
\]

For product characteristic:
\[
o_t' \in \{o_t - \Delta o,\; o_t,\; o_t + \Delta o\}.
\]

For each candidate pair \((p', o')\), profit 
\(\widehat{\pi}(p', o')\) is computed.

The firm then updates its decision according to:
\[
(p_{t+1}, o_{t+1})
=
\arg\max_{(p',o')}
\widehat{\pi}(p', o').
\]

Boundary conditions are imposed to ensure:
\[
p_{t+1} \ge 0,
\qquad
o_{t+1} \in [0,1].
\]

The process is repeated for a fixed number of iterations $T$. Convergence is assessed by examining whether decision variables fluctuate within a narrow range and whether profit stabilizes. Because the algorithm is based on local improvements, it converges to a neighborhood of a local maximum of the profit function.

\paragraph{Implementation of a two-firm algorithm.}

In the duopoly extension, for each consumer \(i\), utilities are computed:
\[
u_{1,i}, \qquad u_{2,i}, \qquad u_{0,i} = 0.
\]

Choice probabilities are given by:
\[
P_{j,i}
=
\frac{\exp\!\big(u_{j,i}\big)}
{1 + \exp\!\big(u_{1,i}\big) + \exp\!\big(u_{2,i}\big)},
\qquad j = 1,2.
\]

Expected demand for firm \(j\) is:
\[
\widehat{Q}_j
=
\sum_{i=1}^{N} P_{j,i}.
\]

Profit is:
\[
\widehat{\pi}_j
=
(p_j - c_j)\, \widehat{Q}_j.
\]

Each firm applies a local search procedure similar to the single-firm case. At each iteration:

\begin{enumerate}[noitemsep]
	\item Given current competitor strategies, a firm evaluates small candidate adjustments to its own price or product characteristic.
	\item Profit is computed using the deterministic demand approximation.
	\item The firm adopts the candidate that yields the highest profit.
\end{enumerate}

Firms update sequentially or alternately, generating a dynamic process in strategy space. Under suitable conditions, the process converges to a stable strategy profile that can be interpreted as an approximate Nash equilibrium.
% --- chapter ---------------------------------------------------------
\clearpage
\section{Simulation results}

%We show the results of simulations for various initial and exogenous parameters. 
In this section, the numerical results of the mathematical models developed in the previous chapters are presented.

We do this by first ensuring that the learning algorithm converges to stable equilibrium outcomes and that the outcome is robust to different initial conditions. Second, we make comparative statics about basic structural parameters that have been included in the model. Thirdly, we study how competition between the firms has impact on the pricing and product design decisions.

The population size during the simulations is fixed at $N=5000$. For the purpose of comparability, consumer characteristics are observed similarly across the experiments except when specified otherwise. With this, differences in outcomes can only be ascribed to changes in parameters and not sampling variability. The study differentiates between initial parameters (the data that constitutes initial values in which the learning process is performed) and exogenous parameters (the economic environment with which it operates).
Exogenous parameters include:
\begin{itemize}[noitemsep]
	\item $\alpha$: price sensitivity of consumers,
	\item $\beta$: taste mismatch sensitivity,
	\item $c$: marginal production cost,
	\item distribution parameters of consumer tastes 
	$S \sim \mathrm{Beta}(a_S, b_S)$.
\end{itemize}
Initial parameters include:
\begin{itemize}[noitemsep]
	\item initial price $p_0$,
	\item initial product characteristic $o_0$.
\end{itemize}

\paragraph{Overview of simulation experiments.}

The numerical analysis consists of six experiments designed to validate convergence of the learning algorithm and study comparative statics with respect to economically meaningful parameters.

\begin{itemize}
	\item \textbf{E1 (Single firm: price sensitivity)}: Vary $\alpha$ while holding other parameters fixed, to quantify how pricing power changes with consumer price sensitivity.
	\item \textbf{E2 (Single firm: taste mismatch)}: Vary $\beta$ under a symmetric taste distribution, to study how mismatch costs affect demand and the optimal product characteristic.
	\item \textbf{E3 (Stability to initial conditions)}: Vary initial values $(p_0,o_0)$ to verify that the algorithm converges to the same equilibrium from different starting points.
	\item \textbf{E4 (Monopoly vs duopoly)}: Compare the single-firm benchmark with the duopoly model to identify competition effects on prices, profits, and market participation.
	\item \textbf{E5 (Duopoly: differentiation test)}: Vary $\beta$ and initial positions $(o_{1,0},o_{2,0})$ to test whether competition generates endogenous differentiation.
	\item \textbf{E6 (Asymmetric tastes)}: Replace the symmetric taste distribution with skewed Beta distributions to examine how equilibrium product style responds to demand asymmetry.
\end{itemize}

In the thesis, we report E1, E4, E6, and the key differentiation outcome from E5, since these provide the most informative comparative statics and the clearest economic mechanisms. Experiments E2 and E3 are primarily validation and robustness checks: E2 confirms that under symmetric tastes the optimal product characteristic remains at the center of demand, while E3 confirms that equilibrium outcomes are stable with respect to initial conditions. The detailed robustness tables for E2 and E3 are summarized in the text.


\subsection{Simulations for a single firm}

First, we analyze the behavior of a monopolistic firm. This company iteratively adjusts its price and product characteristic for expected maximum profit. Convergence arises when the subsequent changes do not enhance profit anymore.

Simulations using alternate starting prices and product properties were performed in order to not base any learning on arbitrary starting values. In each case, the algorithm converged to the same equilibrium pair of variables. This tells us that the profit function exhibits a single dominant local maximum in the region of the considered parameters and that the learning algorithm identifies this equilibrium with relative reliability. Thus, the obtained results are structural characteristics of the model as opposed to initialization.

\begin{figure}[hbt]
	\centering
	\begin{subfigure}[t]{0.45\textwidth}
		\includegraphics[width=\textwidth]{path_single_price.png}
		\caption{Time path of the single-firm price $p_t$ during the learning algorithm.}
		\label{fig:pricesing}
	\end{subfigure}
	\hfill
	\begin{subfigure}[t]{0.45\textwidth}
		\includegraphics[width=\textwidth]{path_single_style.png}
		\caption{Time path of the single-firm product style $o_t$ during the learning algorithm.}
		\label{fig:stylesing}
	\end{subfigure}
	
	\captionsetup{margin=10pt,font=small,labelfont=bf,width=.8\textwidth}
	
	\caption[Time path of the single firm]{Starting from arbitrary initial values, the firm sequentially adjusts price and style to increase expected profit. Both variables converge rapidly to stable levels, indicating attainment of the profit-maximizing strategy. \textit{Source:} own calculations}\label{fig:sing}
\end{figure}

\paragraph{Effect of price sensitivity.}

Here, we first discuss that equilibrium result depends on consumer price sensitivity $\alpha$ with all other parameters fixed. To study the impact of price sensitivity, we fix $\beta = 1$, $c = 0.5$, and initial values $p_0 = 5$, $o_0 = 0.5$, while varying $\alpha \in \{0.5,1,2,3\}$.


\begin{table}[hbt]
	\centering

	\captionsetup{margin=10pt,font=small,labelfont=bf,width=.8\textwidth}

	\caption[Equilibrium outcomes under varying price sensitivity]{Equilibrium outcomes under varying price sensitivity}
	\label{tab:alpha_single}
	\begin{tabular}{ccccc}
		\hline
		$\alpha$ & $p^*$ & $o^*$ & $\Pi^*$ & $Q^*$ \\
		\hline
		0.5 & 11.2 & 0.5 & 9230.29 & 862.644 \\
		1.0 & 5.8  & 0.5 & 4404.33 & 831.007 \\
		2.0 & 3.2  & 0.5 & 2007.07 & 743.583 \\
		3.0 & 2.4  & 0.5 & 1219.22 & 641.697 \\
		\hline
		\vspace*{2ex}
	\footnotesize
	\end{tabular}
\end{table}

\begin{figure}[hbt]
	\centering
	
	\includegraphics[width=.5\textwidth]{fig_alpha_single.png}
	
	\captionsetup{margin=10pt,font=small,labelfont=bf,width=.8\textwidth}
	
	\caption[Optimal price $p^*$ as a function of price sensitivity $\alpha$]{Optimal price $p^*$ as a function of price sensitivity $\alpha$ in the single-firm case. \textit{Source:} own calculations}\label{fig:optimalpricesinglealpha}
\end{figure}

As shown in Table 1 and Figure 5, the optimum price declines sharply with $\alpha$. When consumers are weakly price responsive $\alpha=0.5$, the firm sets relatively high prices (high profits). When price sensitivity is high, the firm’s power to draw on surplus decreases, causing it to lower price. 

The drop in profits is natural in economic point of view. Higher $\alpha$ means that demand responds faster to price changes, which lowers the optimal markup. Therefore, the simulation replicates the classical relationship of demand elasticity with monopoly pricing power. Importantly, in this experiment the ideal product characteristic does not differ. This illustrates the symmetry of the taste distribution and suggests that rather than horizontal product style, price sensitivity mainly plays a role in the vertical dimension of (pricing) preference.

\paragraph{Effect of taste distribution.}

We next vary the distribution of consumer tastes while keeping $\alpha = 1$, $\beta = 1$, and $c = 0.5$ fixed. Three distributions are considered: $\text{Beta}(2,5)$, $\text{Beta}(4,4)$, and $\text{Beta}(5,2)$.

\begin{table}[H]
	\centering

	\captionsetup{margin=10pt,font=small,labelfont=bf,width=.8\textwidth}

	\caption{Product style under asymmetric taste distributions (single firm)}
	\label{tab:taste_single}
	\begin{tabular}{ccccc}
		\hline
		Distribution & $\mathbb{E}[S]$ & $o^*$ & $p^*$ & $\Pi^*$ \\
		\hline
		Beta(2,5) & 0.286 & 0.28 & 5.8 & 4410.869 \\
		Beta(4,4) & 0.500 & 0.50 & 5.8 & 4404.334 \\
		Beta(5,2) & 0.714 & 0.72 & 5.8 & 4410.869 \\
		\hline
		\vspace*{2ex}
	\footnotesize
	\end{tabular}
\end{table}

\begin{figure}[hbt]
	\centering
	\includegraphics[width=.5\textwidth]{fig_taste_single.png}
	\captionsetup{margin=10pt,font=small,labelfont=bf,width=.8\textwidth}
	\caption[Optimal product characteristic $o^*$ as a function of the mean taste]{Optimal product characteristic $o^*$ as a function of the mean taste $\mathbb{E}[S]$. The dashed line represents the 45-degree benchmark. \textit{Source:} own calculations}
	\label{fig:taste_single}
\end{figure}
The optimal product characteristic closely follows the mean of the taste distribution, $o^* \approx \mathbb{E}[S]$. This confirms that product design is driven by the center of consumer demand.

When tastes are skewed toward lower values (Beta(2,5)), the firm shifts its product toward the left side of the characteristic space. When tastes are skewed toward higher values (Beta(5,2)), the firm shifts accordingly to the right.

This result confirms that the model generates economically intuitive behavior: the firm designs its product to align with the center of consumer demand. Importantly, price remains largely unchanged in this experiment, indicating that horizontal demand asymmetry primarily affects product design rather than pricing incentives.

\subsection{Simulations for two firms}

\begin{figure}[hbt]
	\centering
	\begin{subfigure}[t]{0.45\textwidth}
		\includegraphics[width=\textwidth]{path_duopoly_prices.png}
		\caption{Time paths of prices $(p_{1t}, p_{2t})$ in the duopoly model under sequential local best-response updates.}
		\label{fig:pricetwo}
	\end{subfigure}
	\hfill
	\begin{subfigure}[t]{0.45\textwidth}
		\includegraphics[width=\textwidth]{path_duopoly_styles.png}
		\caption{Time paths of product characteristics $(o_{1t}, o_{2t})$ in the duopoly model.}
		\label{fig:styletwo}
	\end{subfigure}
	
	\captionsetup{margin=10pt,font=small,labelfont=bf,width=.8\textwidth}
	
	\caption[Time path of two firms]{Firms adjust strategies in response to each other until a stationary outcome is reached, approximating a Nash equilibrium. \textit{Source:} own calculations}\label{fig:two}
\end{figure}

We generalize the analysis to a duopoly. Each firm uniquely implements the learning algorithm, and the competitor's current approach is treated as given to them; both use it independently. The dynamic process as a result converges to a stable strategy profile.

\paragraph{Monopoly against Duopoly.}

We begin by comparing monopoly and duopoly outcomes under identical structural parameters, which are $\alpha = 1$, $\beta = 1$, and $c_1 = c_2 = 0.5$.

\begin{table}[H]
	\centering
	
	\captionsetup{margin=10pt,font=small,labelfont=bf,width=.8\textwidth}
	
	\caption{Monopoly vs duopoly equilibrium outcomes}
	\label{tab:monopoly_duopoly}
	\begin{tabular}{cccc}
		\hline
		Market Structure & $p^*$ & $o^*$ & Profit per firm \\
		\hline
		Monopoly & 5.8 & 0.5 & 4404.334 \\
		Duopoly  & 5.4 & 0.5 & 3584.391 \\
		\hline
		\vspace*{2ex}
		\footnotesize
	\end{tabular}
\end{table}

Total duopoly profit equals 7168.78. The outside option share is approximately 0.704.

The existence of the second firm brings down equilibrium prices. This result is influenced by the competitive pressure: each of the two sides has an interest to just slightly underprice the rival to gain market share. This leads to a lower share of per-firm profit as compared to the monopoly benchmark. Curiously, both firms choose the same product attributes. In this symmetric equilibrium case, there is no endogenous differentiation despite competition. The point is hence the minimum differentiation at equilibrium. This result is consistent with the structure of multinomial logit demand under symmetric costs and preferences.

\paragraph{Taste asymmetry under competition.}

Finally, we analyze how duopoly outcomes change when the distribution of agents tastes becomes asymmetric. We repeat the asymmetric taste experiment in the duopoly setting.

\begin{table}[H]
	\centering
	
	\captionsetup{margin=10pt,font=small,labelfont=bf,width=.8\textwidth}
	
	\caption{Duopoly style under asymmetric taste distributions}
	\label{tab:taste_duopoly}
	\begin{tabular}{ccccc}
		\hline
		Distribution & $\mathbb{E}[S]$ & $o_1^*$ & $o_2^*$ & $|o_1^* - o_2^*|$ \\
		\hline
		Beta(2,5) & 0.286 & 0.28 & 0.28 & $\approx 0$ \\
		Beta(4,4) & 0.500 & 0.50 & 0.50 & $\approx 0$ \\
		Beta(5,2) & 0.714 & 0.72 & 0.72 & $\approx 0$ \\
		\hline
		\vspace*{2ex}
		\footnotesize
	\end{tabular}
\end{table}

\begin{figure}[H]
	\centering
	\captionsetup{margin=10pt,font=small,labelfont=bf,width=.8\textwidth}
	\includegraphics[width=.5\textwidth]{fig_taste_duopoly.png}
	\caption[Firm styles in the duopoly case]{Firm styles as a function of the mean taste in the duopoly case. \textit{Source:} own calculations}
	\label{fig:taste_duopoly}
\end{figure}

Both firms change the characteristics of their products when demand changes, as demonstrated by the simulations. Similar to the case of monopoly, firm positions move toward the mean of the taste distribution. But even when demand is asymmetric, firms converge to identical product characteristics. Hence, the model does not generate endogenous differentiation in equilibrium, as $o_1^* = o_2^*$ in all cases. Instead, both firms cluster at the center of consumer demand.

This outcome reflects the symmetric structure of costs and the substitution patterns implied by the logit demand system.

% --- chapter ---------------------------------------------------------
\clearpage
\section{Conclusions}

Within this thesis were built and simulated the mathematical model that describes firm behaviour in the presence of a heterogeneity of consumer preferences. It aimed to study the optimal prices and product characteristics that firms determine, and to analyze how those choices change under competition. 

The model consists of heterogeneous consumers with logit-based demand and profit-maximizing firms with price and product style change. Since there are no available analytical solutions, equilibrium results have been obtained by a structured numerical learning algorithm. 

The simulation results provide several important conclusions. First, price sensitivity is the principal determinant of pricing power. And as consumers become more price sensitive when buying certain products, the optimal prices drop so sharply that equilibrium profits fall as well. This supports the classical relation between demand elasticity and markups. Second, product design is dictated by the distribution of market tastes. The mean of the taste distribution closely follows the optimal product feature. Asymmetric preferences make firms rearrange product style accordingly. This shows that the horizontal differentiation in the model is really driven by the demand. Third, competition lowers the price and per firm earnings compared to monopoly outcomes. Except, at symmetric costs and logit demand, the duopoly equilibrium shows minimum differentiation: firms converge on identical product features. Although demand asymmetry distorts the equilibrium location, it does not provide endogenous differentiation within this context. 

The simulations hold to changes in initial conditions and thus reflect stable equilibrium performance. The models also provide with an economically intuitive comparative statics that show that consumer heterogeneity influences pricing and product choices under monopoly, as well as duopoly conditions. Such insights emphasize the beneficial application of computational methods to explain certain strategic firm activity when closed-form analytical tools fail to result.

% --- bibliography ----------------------------------------------------
\clearpage
\printbibliography[heading=subbibliography,nottype=online,title={References}]
\printbibliography[heading=subbibliography,type=online,title={Online references}]

% --- abstract --------------------------------------------------------
\clearpage
\addcontentsline{toc}{section}{List of tables}
\listoftables

% --- abstract --------------------------------------------------------
\clearpage
\addcontentsline{toc}{section}{List of figures}
\listoffigures



% --- abstract --------------------------------------------------------
\clearpage
\addcontentsline{toc}{section}{Abstract}
\section*{Abstract}

%Tutaj zamieszczają Państwo streszczenie pracy. Streszczenie powinno być długości około pół strony.

This thesis aims to create and simulate a mathematical model of firm behavior under heterogeneous consumer preferences. Consumers differ in income and taste, and firms select prices and product characteristics in order to maximize expected profit under logit demand. Since closed-form solutions are not present, equilibrium outcomes are obtained using a numerical learning algorithm. Both monopoly and duopoly scenarios are analyzed. Simulation results suggest that higher price sensitivity lowers the optimal prices and profits, while the product design follows the center of the consumer taste distribution. In a duopoly, competition reduces prices but leads to minimum differentiation under symmetric conditions. The findings demonstrate how heterogeneity of consumers shapes pricing and product style decisions and illustrate the usefulness of computational methods in applied microeconomic modeling.

\end{document}


%%% Local Variables:
%%% mode: latex
%%% TeX-master: t
%%% End:
